
﻿<?php
/************************************************************************************************************************************************************************************************************
 ************************************************************************************************************************************************************************************************************
 ***                                                                                                                                                                                                      ***
 ***                                                                                                     *****page d'index*****                                                                           ***
 ***                                                                                                                                                                                                      ***
 ************************************************************************************************************************************************************************************************************
 ************************************************************************************************************************************************************************************************************/
/**
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **/
/************************************************************************************************************************************************************************************************************
 ************************************************************************************************************************************************************************************************************
 ***                                                                                                                                                                                                      ***
 ***                                                                                    *****Recupération des valeurs clés *****                                                                          ***
 ***                                                                                                                                                                                                      ***
 *** Config.php : contient toutes les variables globales : nom, prenom, statut, ainsi que la configuration de la page d'index                                                                             ***
 ***                                                                                                                                                                                                      ***/
require("./layout/config.php");
$user_mail="myemail@mylab.fr"; /// <------------------------------ your email
$user_lab=[ //<------------ // your lab logo, link and name
"logo"=>"images/logoIBISC.png",
"link"=>"http://www.ibisc.univ-evry.fr/",
"name"=>"IBISC"
];
$user_affiliation=[ //<------------ // your affiliations logo, link and name
	["logo"=>"images/logoueve.png",
	"link"=>"http://www.univ-evry.fr/",
	"name"=>"logo Univ Evry"],
	["logo"=>"images/logo-genopole.png",
	"link"=>"http://www.genopole.fr/",
	"name"=>"logo Génopole"]
];



$title_web_bar="Homepage : ".ucwords(constant('UNAME'))." ".strtoupper(constant('UFNAME'));
$page_title=ucwords(constant('UNAME'))." ".strtoupper(constant('UFNAME'));
/***                                                                                                                                                                                                      ***
 *** cv.xml : contient les mots clé pour réferencer la page.                                                                                                                                              *** 
 ***                                                                                                                                                                                                      ***/
$cv_xml=simplexml_load_file('cv.xml');
$user_keywords=$cv_xml->keywords;
unset($cv_xml);
/***                                                                                                                                                                                                      ***
 ************************************************************************************************************************************************************************************************************
 ************************************************************************************************************************************************************************************************************/
/**
 **
 **
 **
 **
 **/
/************************************************************************************************************************************************************************************************************
 ************************************************************************************************************************************************************************************************************
 ***                                                                                                                                                                                                      ***
 ***                                                                                     *****Génération de l'adresse mail*****                                                                           ***
 ***                                                                                                                                                                                                      ***
 ************************************************************************************************************************************************************************************************************
 ************************************************************************************************************************************************************************************************************/
function encode_mail($user_mail){
 $place=48;
 $mail_lenght=strlen($user_mail);
 for($i=0;$i<$mail_lenght;$i++){
  $char_place[$i]=$place;
  $place=($place*48)%127;
 }
 $str_encode_mail="";
 for($i=0;$i<127;$i++){
  do{
   $char_item_val=rand(44,126);
   
  }while($char_item_val==92);
  $char_item=chr($char_item_val);
  $str_encode_mail=$str_encode_mail.$char_item;
 }
 for($i=0;$i<$mail_lenght;$i++){
  $str_encode_mail[$char_place[$i]]=$user_mail[$i];
 }
return $str_encode_mail;
}
$user_mail_encode=encode_mail($user_mail);
/************************************************************************************************************************************************************************************************************
 ************************************************************************************************************************************************************************************************************
 ************************************************************************************************************************************************************************************************************/
/**
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **/
/************************************************************************************************************************************************************************************************************
 ************************************************************************************************************************************************************************************************************
 ***                                                                                                                                                                                                      ***
 ***                                                                                          *****Génération du menu*****                                                                                ***
 ***                                                                                                                                                                                                      ***
 ************************************************************************************************************************************************************************************************************
 ************************************************************************************************************************************************************************************************************/
function set_menu($menu){
$n_menu=count($menu);
echo "<DIV id=\"menu\">";//conteneur du menu
 for($i=0;$i<$n_menu;$i++){
  echo "<DIV class=\"menu_el\">";//element du menu
  echo "<form id=\"".$menu[$i]."\" action=\"index.php\" method=\"post\">";//formulaire pour rappeler la meme page
  if(defined('TD') && 
$menu[$i]==constant('TD')){
   echo "<input type=\"hidden\" name=\"menu_mat\" value=\"".constant('TD')."\"/>";
  }else if(defined('TEACHING') && 
$menu[$i]==constant('TEACHING')){
   echo "<input type=\"hidden\" name=\"menu_mat\" value=\"".constant('TEACHING')."\"/>";
  }
  echo "<input type=\"hidden\" name=\"menu_link\" value=\"".$i."\"/>";
  echo "</form>";
  echo "<a class=\"ref_menu_el\" href='#' onclick='document.getElementById(\"".$menu[$i]."\").submit()'><P class=\"menu_el_title\">".$menu[$i]."</P></DIV></a>";
 }
echo "</DIV>";
}
/************************************************************************************************************************************************************************************************************
 ************************************************************************************************************************************************************************************************************
 ************************************************************************************************************************************************************************************************************/
/**
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **
 **/
/************************************************************************************************************************************************************************************************************
 ************************************************************************************************************************************************************************************************************
 ***                                                                                                                                                                                                      ***
 ***                                                                                          *****Index.php (MAIN)*****                                                                                  ***
 ***                                                                                                                                                                                                      ***
 ************************************************************************************************************************************************************************************************************
 ************************************************************************************************************************************************************************************************************/
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr"> 
 <HEAD>
  <TITLE><?php echo $title_web_bar; ?></TITLE>
  <meta http-equiv="content-style-type" content="text/css;charset=iso-8859-1" /> 
  <?php echo "<meta name=\"content-language\" content=\"".constant('LANG')."\" />"; /************************  langue de la page */ ?> 
  <?php echo "<meta name=\"title\" content=\"".$title_web_bar."\" />"; /************************  titre de la page */ ?> 
  <?php echo "<meta name=\"keywords\" content=\"".$user_keywords.",Ibisc,Universite d\'Evry\" />";/************************  Mots clés de la page */  ?> 
  <meta name="author" content="Adrien Basso-Blandin, ENS Lyon" />
  <link rel="stylesheet" type="text/css" href="layout/Ibisc.css" /> 
 </HEAD>
 <BODY>
  <DIV id="page"><!--page web -->
   <DIV id="container"><!-- contient toute la page : taille fixe 1024*758 -->
    <DIV id="logo"><!--le logo ibisc -->
     <A href=<?php echo $user_lab["link"]; ?>><IMG src=<?php echo $user_lab["logo"]; ?> alt=<?php echo $user_lab["name"]; ?>/></A>
    </DIV>
    <DIV id="header">
     <DIV id="title">
      <?php echo $page_title."<br />"; /************************  Titre affiché dans l'index !!!!! potentiellement différent de celui affiché dans l'entete de page */ ?>
     </DIV><DIV id="email">
      <script type="text/javascript">
      <!--
      //fonction java de masquage contre robot
      function write_mail(){
       var d="";
       var st="";
       var place=48;
       var count=<?php echo strlen($user_mail).";\n"; ?>
       var decode=<?php echo "\"".$user_mail_encode."\";\n"; ?>
       for(var i=0; i<count; i++){
        d+=String.fromCharCode(decode.charCodeAt(place));
        place = (place*48) % 127;
       }
       document.write("<a href=mailto:");
       document.write(d);
       document.write(">"); document.write(d); document.write("</a>"); 
      }
      write_mail();
   // End the hiding here. -->
     </script>
      </DIV>
    </DIV>
    <DIV id="main"><!-- contenue de la page -->
     <?php /****************************************************  gestion du menu */ 
      if(isset($_POST["menu_link"])){
       $current_page=$menu_path[$_POST["menu_link"]];
      }
      else{
       $current_page=HOME_PATH;
      }
      require($current_page);
     ?>
    </DIV>
    <?php set_menu($menu); /**************************************  affichage du menu */ ?>
    <DIV id="footer"><!-- les logo et les liens -->
	 <?php
	  $affil_cnt=count($user_affiliation);
	  for($i=0;$i<$affil_cnt;$i++){
		echo "<A href=".$user_affiliation[$i]["link"]."><IMG src=".$user_affiliation[$i]["logo"]."alt=".$user_affiliation[$i]["name"]."width='130'/></A>";
	  }
	 ?>
    </DIV>
   </DIV>
  </DIV>
 </BODY>
</HTML>
<?php 
/************************************************************************************************************************************************************************************************************
 ************************************************************************************************************************************************************************************************************
 ************************************************************************************************************************************************************************************************************/
?>